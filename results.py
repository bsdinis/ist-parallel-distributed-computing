#!/usr/bin/env python3

from collections import defaultdict

serial = 33.0

approach = {
    'worst': { 1: [38.7,47.8,33.4,33.0,33.2], 2: [19.5,19.5,19.6,19.5,19.5], 4: [13.1,13.1,13.0,13.2,13.1], 5: [13.6,13.6,13.9,13.6,13.5], 8: [15.3,15.3,14.6,14.6,14.7], },
    'only': { 1: [33.0,33.0,33.0,33.2,33.2], 2: [19.8,19.7,19.7,19.7,19.7], 4: [13.1,13.1,13.2,13.2,13.1], 5: [13.3,13.3,13.3,13.3,13.3], 8: [13.3,13.3,13.2,13.3,13.3],},
    'ours': { 1: [33.0,32.9,33.1,32.9,33.0], 2: [19.6,19.5,19.6,19.5,19.6], 4: [13.2,12.9,12.9,13.1,13.1], 5: [13.1,13.1,13.2,13.2,13.1], 8: [13.1,13.2,13.1,13.3,13.1],},
}

def avg(l): return sum(l)/len(l)

bench = {
        # 3
    '20 1000000 0':{ 1:[3.2, 3.2, 3.2, 3.2, 3.2],2:[2.1, 2.1, 2.1, 2.1, 2.1],4:[1.5, 1.5, 1.5, 1.5, 1.5],5:[1.5, 1.5, 1.5, 1.5, 1.5],8:[1.5, 1.4, 1.5, 1.5, 1.5]},
    # 4
    '3 5000000 0': { 1: [5.3,5.3,5.3,5.3,5.3], 2: [3.2,3.2,3.2,3.2,3.2], 4:[2.2,2.2,2.2,2.2,2.2], 5:[2.2,2.2,2.2,2.2,2.2], 8:[2.2,2.2,2.2,2.2,2.2] },
    # 5
    '4 10000000 0': { 1: [14.3,14.3,14.3,14.3,14.3], 2:[8.6,8.7,8.6,8.9,9.3], 4:[7.1,7.0,7.3,8.6,9.2], 5:[9.1,9.4,9.0,8.6,9.1], 8:[8.8,8.6,8.5,8.8,8.8], },
    # 6
    '3 20000000 0': { 1: [38.6,31.0,27.4,27.4,27.3], 2:[15.9,15.6,15.6,15.8,15.8], 4:[11.1,10.8,10.5,10.7,10.6], 5:[12.8,12.7,12.7,12.5,12.5], 8:[12.8,12.6,12.6,12.7,12.6], },
    # 7
    '4 20000000 0': { 1: [33.0,32.9,33.1,32.9,33.0], 2: [19.6,19.5,19.6,19.5,19.6], 4: [13.2,12.9,12.9,13.1,13.1], 5: [13.1,13.1,13.2,13.2,13.1], 8: [13.1,13.2,13.1,13.3,13.1],},
}


levels = [
{'gen': 0.898887816817, '0': 0.76667480031, '1': 0.913762371056, '2': 1.2289988771079998, '3': 1.6912103584040001, '4': 1.92974778684, '5': 2.1339315180689997, '6': 2.2467628675560007, '7': 2.359570983327999, '8': 2.410503402818, '9': 2.3390857800869975, '10': 1.9270360227710008, '11': 1.7604887843980042, '12': 1.6479045506559975, '13': 1.5711251515879976, '14': 1.2081495891760055, '15': 0.8740482628440008, '16': 0.7273182370469977, '17': 0.7056843312209906, '18': 0.747582381183015, '19': 0.8007780510130172, '20': 0.8859792837857463, '21': 1.0639630148541983, '22': 1.1835508270637762, '23': 1.2409887142356433, '24': 0.698932092275508},
{'gen': 0.904183136765, '0': 0.768976869993, '1': 0.916885482147, '2': 1.23080288153, '3': 1.694240715821, '4': 1.9425951158609998, '5': 2.1499787657530005, '6': 2.29512812151, '7': 2.4319809549509994, '8': 2.504292713935999, '9': 2.4000390740049995, '10': 1.9045410407799983, '11': 1.7503833477539987, '12': 1.6690115328140018, '13': 1.5905180974089999, '14': 1.2164782602580029, '15': 0.8797929566390011, '16': 0.7279004584150025, '17': 0.7037800584830051, '18': 0.7453428318120211, '19': 0.7965350130840163, '20': 0.8841203107347521, '21': 1.0714695100181781, '22': 1.1889386728755882, '23': 1.2478672501868178, '24': 0.7039736560651947},
{'gen': 0.901866584085, '0': 0.753417198081, '1': 1.178291104268, '2': 1.6878714179620002, '3': 2.425130431075, '4': 2.8752580164009998, '5': 2.6814952250580006, '6': 2.963574921714999, '7': 3.0520182661680013, '8': 3.1936243902920025, '9': 3.3361815740360004, '10': 3.301573304452001, '11': 2.8538707014900035, '12': 2.796522778897995, '13': 2.5270876628929875, '14': 2.0770552134710027, '15': 1.4425359586699869, '16': 1.0497446446200085, '17': 0.8693360925079775, '18': 0.882611609136019, '19': 0.9566577461360722, '20': 1.1522126105609891, '21': 1.395967955997166, '22': 1.5976297354240496, '23': 1.79984332636859, '24': 1.0564660079034087},
{'gen': 0.898951256648, '0': 0.75038648583, '1': 0.914195777849, '2': 1.233604758512, '3': 1.712286633439, '4': 1.9345599589869997, '5': 2.14989527501, '6': 2.2839479004040006, '7': 2.432365485474, '8': 2.4980157208620004, '9': 2.4402602450049993, '10': 2.030227891634005, '11': 1.857104494231998, '12': 1.7718730731890004, '13': 1.703135930973997, '14': 1.2878588861759996, '15': 0.902661767387998, '16': 0.7387789343629998, '17': 0.7079655911709967, '18': 0.7466232729540069, '19': 0.8017876497650628, '20': 0.8892332132917281, '21': 1.0757954864471115, '22': 1.18663206664653, '23': 1.2391048353474228, '24': 0.7081590978978457},
{'gen': 0.888050514273, '0': 0.752335314173, '1': 0.916731192265, '2': 1.7455515153700003, '3': 2.5869288225659997, '4': 2.844335017259, '5': 3.123896980194, '6': 3.2814320786819997, '7': 3.4311201227859973, '8': 3.7955707372200025, '9': 3.9622908038960007, '10': 3.429690109111001, '11': 3.253316229665002, '12': 2.8792879194980006, '13': 2.970780846647005, '14': 2.150770043426999, '15': 1.496524275700999, '16': 1.2839936767189954, '17': 0.9543660085739974, '18': 1.0143294266270162, '19': 1.1815906965380454, '20': 1.3346205263529132, '21': 1.6615516638925516, '22': 1.8516830581798738, '23': 1.7474083981408397, '24': 1.024438544257031}
]

transposed = defaultdict(lambda: [])
for l in levels:
    for k, v in l.items():
        transposed[k].append(v)

for a in ['ours', 'only', 'worst']:
    with open('{}.dat'.format(a), 'w') as f:
        for idx in [1, 2, 4, 5, 8]:
            print('{0} {2} {1}'.format(idx, avg(approach[a][idx]), serial/avg(approach[a][idx])), file=f)

for k in bench:
    with open('{}.dat'.format(k.replace(' ', '_')), 'w') as f:
        for idx in [1, 2, 4, 5, 8]:
            print('{0} {2} {1}'.format(idx, avg(bench[k][idx]), avg(bench[k][1])/avg(bench[k][idx])), file=f)


with open('levels.dat', 'w') as f:
    for i, (k, v) in enumerate(transposed.items()):
        print('{} {} {}'.format(i, k, avg(v)), file=f)
